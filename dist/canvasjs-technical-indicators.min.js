(function(){var d=window.CanvasJS||d?window.CanvasJS:null;if(d&&d.Chart){d.Chart.prototype.updateCustomOptions=function(a){a&&a.technicalIndicators&&(a.technicalIndicators.sma&&(this.technicalIndicators.sma=a.technicalIndicators.sma||{},this.technicalIndicators.sma.enabled=a.technicalIndicators.sma.enabled||!1,this.technicalIndicators.sma.linkedDataSeriesIndex=a.technicalIndicators.sma.linkedDataSeriesIndex||0,this.technicalIndicators.sma.period=a.technicalIndicators.sma.period||5),a.technicalIndicators.ema&&(this.technicalIndicators.ema=a.technicalIndicators.ema||{},this.technicalIndicators.ema.enabled=a.technicalIndicators.ema.enabled||!1,this.technicalIndicators.ema.linkedDataSeriesIndex=a.technicalIndicators.ema.linkedDataSeriesIndex||0,this.technicalIndicators.ema.period=a.technicalIndicators.ema.period||5))};d.Chart.prototype.addTechnicalIndicators=function(){function a(b,f){var g=[];f=f||5;for(var c=0;c<f;c++)g.push({x:b[c].x,y:null});c=f-1;for(var e=b.length;c<e;c++){for(var m=b.slice(c-f+1,c),n=0,p=0,k=0;k<m.length;k++){var h=m[k].y[3];n+=h;p++}h=n/p;isNaN(h)?g.push({x:b[c].x,y:null}):g.push({x:b[c].x,y:h})}return g}function l(b,f){for(var g=2/(f+1),c=[{x:b[0].x,y:b[0].y.length?b[0].y[3]:b[0].y}],e=1;e<b.length;e++)c.push({x:b[e].x,y:(b[e].y.length?b[e].y[3]:b[e].y)*g+c[e-1].y*(1-g)});return c}this.technicalIndicators={};this.updateCustomOptions(this.options);this.options.technicalIndicators&&this.technicalIndicators.sma&&this.technicalIndicators.sma.enabled&&(this.technicalIndicators.sma.dataPoints=a(this.options.data[this.technicalIndicators.sma.linkedDataSeriesIndex].dataPoints,this.technicalIndicators.sma.period),this.technicalIndicators.sma.added||(this.options.data.push({type:"line",dataPoints:this.technicalIndicators.sma.dataPoints,color:this.technicalIndicators.sma.color||null,showInLegend:this.technicalIndicators.sma.showInLegend||!1,name:this.technicalIndicators.sma.name||""}),this.technicalIndicators.sma.added=!0));this.options.technicalIndicators&&this.technicalIndicators.ema&&this.technicalIndicators.ema.enabled&&(this.technicalIndicators.ema.dataPoints=l(this.options.data[this.technicalIndicators.ema.linkedDataSeriesIndex].dataPoints,this.technicalIndicators.ema.period),this.technicalIndicators.ema.added||(this.options.data.push({type:"line",dataPoints:this.technicalIndicators.ema.dataPoints,color:this.technicalIndicators.ema.color||null,showInLegend:this.technicalIndicators.ema.showInLegend||!1,name:this.technicalIndicators.ema.name||""}),this.technicalIndicators.ema.added=!0))};var q=d.Chart.prototype.render;d.Chart.prototype.render=function(a){this.addTechnicalIndicators();return q.apply(this,arguments)}}if(d&&d.StockChart){d.StockChart.prototype.updateCustomOptions=function(){this.options&&this.options.technicalIndicators&&(this.options.technicalIndicators.sma&&(this.technicalIndicators.sma=this.options.technicalIndicators.sma||{},this.technicalIndicators.sma.linkedChartIndex=this.options.technicalIndicators.sma.linkedChartIndex||0),this.options.technicalIndicators.ema&&(this.technicalIndicators.ema=this.options.technicalIndicators.ema||{},this.technicalIndicators.ema.linkedChartIndex=this.options.technicalIndicators.ema.linkedChartIndex||0))};d.StockChart.prototype.addTechnicalIndicators=function(){this.technicalIndicators={};this.updateCustomOptions();for(var a=0;a<this.charts.length;a++)a===this.technicalIndicators.ema.linkedChartIndex&&(this.charts[a].options.technicalIndicators={ema:this.options.technicalIndicators.ema},this.charts[a].addTechnicalIndicators()),a===this.technicalIndicators.sma.linkedChartIndex&&(this.charts[a].options.technicalIndicators={sma:this.options.technicalIndicators.sma},this.charts[a].addTechnicalIndicators())};var r=d.StockChart.prototype.render;d.StockChart.prototype.render=function(a){var l=r.apply(this,arguments);this.addTechnicalIndicators();for(var b=0;b<this.charts.length;b++)this.charts[b].render();return l}}})();